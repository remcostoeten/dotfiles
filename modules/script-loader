#!/usr/bin/env bash

function load_scripts() {
    local script_dir="$DOTFILES_MODULES/scripts"
    
    if [[ ! -d "$script_dir" ]]; then
        echo.debug "No script directory found at $script_dir"
        return 0
    fi
    
    echo.debug "Loading scripts..."
    
    local count=0
    local failed=0
    
    for script_file in "$script_dir"/*; do
        [[ ! -f "$script_file" ]] && continue
        
        local filename=$(basename "$script_file")
        
        if [[ "$filename" == *.disabled ]]; then
            echo.debug "  ⊗ $filename (disabled)"
            continue
        fi
        
        count=$((count + 1))
        
        if safe_source "$script_file"; then
            echo.debug "  ✓ $filename"
        else
            failed=$((failed + 1))
            echo.error "  ✗ Failed to load $filename"
        fi
    done
    
    if [[ $count -gt 0 ]]; then
        echo.debug "Loaded $((count - failed))/$count script files"
    fi
}

load_scripts || true
