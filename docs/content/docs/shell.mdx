---
title: Shell Configuration
description: Fish shell setup, customization, and advanced usage patterns
---

## Fish Shell Configuration

<PlatformBadge platform="cross-platform" /> The dotfiles collection provides a comprehensive Fish shell configuration designed for developer productivity and ease of use.

## Features Overview

### Enhanced Prompt
- Git status integration
- Current directory with smart truncation
- Virtual environment indicators
- Command execution time display
- Exit code indicators

### Custom Functions
All functions are automatically loaded and available system-wide:

```fish
# File operations
copy              # Advanced file copying
file-utils        # File management utilities

# Development workflow
git-commit        # Interactive git commit helper
node-clean        # Node.js cache cleaning
node-reinstall    # Complete dependency reinstallation
kill-ports        # Port management

# System utilities
webcam-mic        # Media device controls
```

### Intelligent Aliases
Smart command shortcuts that adapt to your workflow:

```fish
# Git shortcuts
alias g="git"
alias ga="git add"
alias gc="git commit"
alias gp="git push"
alias gl="git log --oneline"

# Development shortcuts
alias nr="npm run"
alias yi="yarn install"
alias pi="pnpm install"
alias serve="python -m http.server"

# System shortcuts
alias ll="ls -la"
alias la="ls -A"
alias l="ls -CF"
```

## Installation & Setup

### Automatic Installation

<PlatformBadge platform="linux" /> **Linux (Ubuntu/Debian):**

```bash
# Install Fish shell
sudo apt update && sudo apt install fish

# Set as default shell
chsh -s $(which fish)

# Load dotfiles configuration
source ~/.config/dotfiles/env/init.fish
```

<PlatformBadge platform="macos" /> **macOS:**

```bash
# Install via Homebrew
brew install fish

# Add to available shells
echo $(which fish) | sudo tee -a /etc/shells

# Set as default shell
chsh -s $(which fish)

# Load dotfiles configuration
source ~/.config/dotfiles/env/init.fish
```

### Manual Configuration

If you prefer manual setup or want to understand the configuration:

```fish
# Add to ~/.config/fish/config.fish
source ~/.config/dotfiles/config.fish

# Or add dotfiles bin to PATH
set -gx PATH ~/.config/dotfiles/bin $PATH

# Source helper functions
source ~/.config/dotfiles/internal/loaders/source-factory.fish
```

## Configuration Structure

### Main Configuration File
Located at `~/.config/dotfiles/config.fish`:

```fish
# Environment variables
set -gx EDITOR nvim
set -gx BROWSER firefox
set -gx PAGER less

# PATH management
set -gx PATH ~/.config/dotfiles/bin $PATH
set -gx PATH ~/.local/bin $PATH

# Development settings
set -gx NODE_ENV development
set -gx DOTFILES_ROOT ~/.config/dotfiles

# Load functions
source ~/.config/dotfiles/internal/loaders/source-factory.fish
```

### Function Loading System
Functions are automatically discovered and loaded from:

```
internal/helpers/
├── copy-helper.fish
├── git-commit-helper.fish
├── kill-ports-helper.fish
├── node-clean-helper.fish
└── webcam-mic-helper.fish
```

### Bootstrap System
The bootstrap system ensures consistent configuration across environments:

```fish
# ~/.config/dotfiles/internal/bootstrap/setup-fish-config.fish
function setup_fish_config
    # Create Fish config directory if it doesn't exist
    mkdir -p ~/.config/fish
    
    # Link dotfiles configuration
    ln -sf ~/.config/dotfiles/config.fish ~/.config/fish/config.fish
    
    # Set up completions
    ln -sf ~/.config/dotfiles/completions ~/.config/fish/completions
end
```

## Advanced Customization

### Custom Functions

Create new functions by adding files to `internal/helpers/`:

```fish
# internal/helpers/my-function-helper.fish
function my_function_helper
    set -l description "My custom function"
    
    # Function implementation
    echo "Hello from my custom function!"
end
```

Then create the executable wrapper:

```fish
#!/usr/bin/env fish
# bin/my-function.fish

source ~/.config/dotfiles/internal/helpers/my-function-helper.fish

function my-function
    my_function_helper $argv
end

my-function $argv
```

### Environment Variables

Add custom environment variables to platform-specific files:

```bash
# env/common/env.sh (cross-platform)
export MY_CUSTOM_VAR="value"

# env/linux/env.sh (Linux-specific)
export LINUX_SPECIFIC_VAR="linux-value"

# env/macos/env.sh (macOS-specific)  
export MACOS_SPECIFIC_VAR="macos-value"
```

### Custom Aliases

Add aliases to the main configuration file:

```fish
# ~/.config/dotfiles/config.fish
alias myalias="my command"
alias project="cd ~/Projects"
alias docs="cd ~/.config/dotfiles/docs"
```

## Performance Optimization

### Lazy Loading
Functions are loaded on-demand to improve shell startup time:

```fish
# Only load heavy functions when needed
function __load_heavy_function
    if not functions -q heavy_function
        source ~/.config/dotfiles/internal/helpers/heavy-function-helper.fish
    end
end

function heavy-command
    __load_heavy_function
    heavy_function $argv
end
```

### Completion Caching
Command completions are cached for improved performance:

```fish
# Cache expensive completions
function __cache_completions
    set -l cache_file ~/.cache/fish/custom_completions
    
    if test ! -f $cache_file -o (find $cache_file -mtime +1)
        generate_completions > $cache_file
    end
    
    cat $cache_file
end
```

## Troubleshooting

### Common Issues

#### Functions Not Loading
```fish
# Check if functions are available
functions | grep -E "(copy|git-commit|kill-ports)"

# Manually reload functions
source ~/.config/dotfiles/internal/loaders/source-factory.fish
```

#### Path Issues
```fish
# Check current PATH
echo $PATH

# Verify dotfiles bin is in PATH
echo $PATH | grep dotfiles

# Reload configuration
source ~/.config/dotfiles/config.fish
```

#### Permission Errors
```bash
# Fix permissions
chmod +x ~/.config/dotfiles/bin/*
chmod +x ~/.config/dotfiles/internal/helpers/*.fish
```

### Performance Issues

#### Slow Shell Startup
```fish
# Profile shell startup
fish --profile /tmp/fish_profile.txt -c exit
cat /tmp/fish_profile.txt

# Identify slow components
time fish -c "source ~/.config/dotfiles/config.fish"
```

#### High Memory Usage
```fish
# Check loaded functions
functions | wc -l

# Unload unused functions
functions -e unused_function

# Clear completion cache
rm -rf ~/.cache/fish/completions
```

## Integration Examples

### Editor Integration

#### VS Code
Add to your VS Code settings:

```json
{
  "terminal.integrated.defaultProfile.linux": "fish",
  "terminal.integrated.defaultProfile.osx": "fish",
  "terminal.integrated.profiles.linux": {
    "fish": {
      "path": "/usr/bin/fish",
      "args": ["-l"]
    }
  }
}
```

#### Vim/Neovim
```vim
" Set Fish as shell for terminal commands
set shell=/usr/bin/fish
```

### CI/CD Integration

#### GitHub Actions
```yaml
- name: Setup Fish Shell
  run: |
    sudo apt-get update
    sudo apt-get install fish
    fish --version

- name: Load Dotfiles
  run: |
    git clone ${{ github.repository }} ~/.config/dotfiles
    fish -c "source ~/.config/dotfiles/env/init.fish"
```

## Best Practices

### Function Design
1. **Single Responsibility**: Each function should do one thing well
2. **Error Handling**: Always check for errors and provide helpful messages
3. **Documentation**: Include help text and examples
4. **Platform Compatibility**: Test on both Linux and macOS

### Performance Guidelines
1. **Lazy Loading**: Load heavy functions only when needed
2. **Caching**: Cache expensive operations
3. **Minimal Startup**: Keep shell startup fast
4. **Resource Cleanup**: Clean up temporary files and variables

### Security Considerations
1. **Input Validation**: Validate all user inputs
2. **Safe Defaults**: Use safe default values
3. **Permission Checks**: Verify file permissions before operations
4. **Path Sanitization**: Sanitize file paths to prevent injection

---

*Next: Learn about [Environment Management](./environment) for cross-platform configuration.*
