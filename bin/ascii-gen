#!/usr/bin/env bash

# ASCII Generator Wrapper
# Part of dotfiles by Remco Stoeten
# This script provides a convenient wrapper for the ASCII art generator

set -euo pipefail

# Colors for output
readonly RED='\033[0;31m'
readonly GREEN='\033[0;32m'
readonly YELLOW='\033[1;33m'
readonly BLUE='\033[0;34m'
readonly PURPLE='\033[0;35m'
readonly CYAN='\033[0;36m'
readonly NC='\033[0m' # No Color

# Get script directory
readonly SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
readonly ASCII_GENERATOR="${SCRIPT_DIR}/../scripts/ascii-generator.js"

# Check if Node.js is available
if ! command -v node >/dev/null 2>&1; then
    echo -e "${RED}Error: Node.js is not installed or not in PATH${NC}" >&2
    echo -e "${YELLOW}Please install Node.js to use the ASCII generator${NC}" >&2
    exit 1
fi

# Check if the ASCII generator script exists
if [[ ! -f "$ASCII_GENERATOR" ]]; then
    echo -e "${RED}Error: ASCII generator script not found at $ASCII_GENERATOR${NC}" >&2
    exit 1
fi

# Function to show help
show_help() {
    echo -e "${CYAN}ASCII Generator Wrapper${NC}"
    echo -e "${PURPLE}A convenient wrapper for generating ASCII art headers${NC}"
    echo ""
    echo -e "${YELLOW}Usage:${NC}"
    echo -e "  ${GREEN}ascii-gen${NC} [options]"
    echo -e "  ${GREEN}ascii-gen${NC} --interactive"
    echo -e "  ${GREEN}ascii-gen${NC} -i"
    echo ""
    echo -e "${YELLOW}Options:${NC}"
    echo -e "  ${GREEN}-i, --interactive${NC}  Run in interactive mode"
    echo -e "  ${GREEN}-h, --help${NC}         Show this help message"
    echo ""
    echo -e "${YELLOW}Examples:${NC}"
    echo -e "  ${GREEN}ascii-gen${NC} --type=docker"
    echo -e "  ${GREEN}ascii-gen${NC} --type=android --lang=fish --name=\"Android Manager\""
    echo -e "  ${GREEN}ascii-gen${NC} --type=ports --output=header.sh"
    echo -e "  ${GREEN}ascii-gen${NC} --interactive"
    echo -e "  ${GREEN}ascii-gen${NC} --help"
    echo ""
    echo -e "${BLUE}This is a wrapper around the Node.js ASCII generator script.${NC}"
    echo -e "${BLUE}Run '${GREEN}ascii-gen --help${BLUE}' to see all available options.${NC}"
}

# If no arguments provided, show help
if [[ $# -eq 0 ]]; then
    show_help
    exit 0
fi

# If help is requested, show help
if [[ "$1" == "--help" ]] || [[ "$1" == "-h" ]]; then
    show_help
    echo ""
    echo -e "${CYAN}--- Full ASCII Generator Help ---${NC}"
    # Pass through to show the full help from the Node.js script
    node "$ASCII_GENERATOR" --help
    exit 0
fi

# If interactive mode is requested
if [[ "$1" == "--interactive" ]] || [[ "$1" == "-i" ]] || [[ "$1" == "--i" ]]; then
    exec node "$ASCII_GENERATOR" --interactive
fi

# Pass all arguments to the Node.js script
exec node "$ASCII_GENERATOR" "$@"